BackendConfig = {}

BackendConfig.pusherKey = <%= Pusher.key.to_json %>

<% if Rails.env.test?  # Configure for pusher-fake in tests only. %>
BackendConfig.pusherOptions = <%= PusherFake.configuration.to_options.to_json %>
<% end %>

app.config (PusherServiceProvider) ->
  opts = BackendConfig.pusherOptions || {}

  # Uncomment for debug.
  # opts.log = (m) -> window.console.log(m)

  PusherServiceProvider
    .setToken(BackendConfig.pusherKey)
    .setOptions(opts)

angular.module("ui.gravatar").config (gravatarServiceProvider) ->
    gravatarServiceProvider.secure = true  # https
    gravatarServiceProvider.defaults =
      size: 40
      default: "mm"  # "Mystery man" silhouette placeholder.
